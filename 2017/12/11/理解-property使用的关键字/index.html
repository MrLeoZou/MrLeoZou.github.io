<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="iOS," />





  <link rel="alternate" href="/atom.xml" title="MrLeoZou" type="application/atom+xml" />






<meta name="description" content="摘要@property是什么众所周知，在iOS开发中，@property是用来声明属性的，默认会自动创建该属性的存储器以及带下划线的成员变量。对于紧随其后的那些关键字也是烂熟于心，信手拈来，但是会用并不代表知道为什么要这样用。 小Tip属性和变量在项目中常见的两种写法：12345678910@interface Tes">
<meta name="keywords" content="iOS">
<meta property="og:type" content="article">
<meta property="og:title" content="理解@property使用的关键字">
<meta property="og:url" content="http://yoursite.com/2017/12/11/理解-property使用的关键字/index.html">
<meta property="og:site_name" content="MrLeoZou">
<meta property="og:description" content="摘要@property是什么众所周知，在iOS开发中，@property是用来声明属性的，默认会自动创建该属性的存储器以及带下划线的成员变量。对于紧随其后的那些关键字也是烂熟于心，信手拈来，但是会用并不代表知道为什么要这样用。 小Tip属性和变量在项目中常见的两种写法：12345678910@interface Test : NSObject&amp;#123;// 声明变量NSString *testN">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-03-26T09:42:44.974Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="理解@property使用的关键字">
<meta name="twitter:description" content="摘要@property是什么众所周知，在iOS开发中，@property是用来声明属性的，默认会自动创建该属性的存储器以及带下划线的成员变量。对于紧随其后的那些关键字也是烂熟于心，信手拈来，但是会用并不代表知道为什么要这样用。 小Tip属性和变量在项目中常见的两种写法：12345678910@interface Test : NSObject&amp;#123;// 声明变量NSString *testN">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"hide","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: 'ECH48TB1OA',
      apiKey: '25717ec7cd487a38231ab7a3d6d8c07a',
      indexName: 'hexo_NAME',
      hits: {"per_page":10},
      labels: {"input_placeholder":"输入关键词进行搜索","hits_empty":"找不到关于“${query}”的文章","hits_stats":"共找到 ${hits} 篇文章，耗时 ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/12/11/理解-property使用的关键字/"/>





  <title>理解@property使用的关键字 | MrLeoZou</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <a href="https://github.com/MrLeoZou" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">MrLeoZou</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">iOS开发者,大前端学习者</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/11/理解-property使用的关键字/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="MrLeoZou">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars1.githubusercontent.com/u/8272390?s=400&u=bbaa08ebea7648f5f5e56559bea1db50cc78d4ca&v=4avatar">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MrLeoZou">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">理解@property使用的关键字</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-11T10:57:43+08:00">
                2017-12-11
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/12/11/理解-property使用的关键字/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/12/11/理解-property使用的关键字/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/12/11/理解-property使用的关键字/" class="leancloud_visitors" data-flag-title="理解@property使用的关键字">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,420
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  9
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><p>@property是什么<br>众所周知，在iOS开发中，@property是用来声明属性的，默认会自动创建该属性的存储器以及带下划线的成员变量。对于紧随其后的那些关键字也是烂熟于心，信手拈来，但是会用并不代表知道为什么要这样用。</p>
<h2 id="小Tip"><a href="#小Tip" class="headerlink" title="小Tip"></a>小Tip</h2><h3 id="属性和变量"><a href="#属性和变量" class="headerlink" title="属性和变量"></a>属性和变量</h3><p>在项目中常见的两种写法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@interface Test : NSObject</span><br><span class="line">&#123;</span><br><span class="line">// 声明变量</span><br><span class="line">NSString *testName;</span><br><span class="line">NSString *testType;</span><br><span class="line">&#125;</span><br><span class="line">// 声明属性</span><br><span class="line">@property(nonatomic,strong) NSString *testName;</span><br><span class="line">@property(nonatomic,strong) NSString *testType;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></p>
<p>以上两种声明的区别在于：<br>（1）声明变量时没有使用到@property，而声明属性时需要用到<br>（2）使用@property声明的属性，默认会自动生成属性的存取器，也就是getter/setter方法，以及带下划线的成员变量；而单独声明变量则没有前者特性。</p>
<hr>
<h2 id="property的关键字"><a href="#property的关键字" class="headerlink" title="@property的关键字"></a>@property的关键字</h2><blockquote>
<p>从大体上我们可以归为三类：原子性，存取控制，内存管理</p>
</blockquote>
<h3 id="原子性"><a href="#原子性" class="headerlink" title="原子性"></a>原子性</h3><h4 id="atomic-nonatomic"><a href="#atomic-nonatomic" class="headerlink" title="atomic | nonatomic"></a>atomic | nonatomic</h4><p><strong>1. atomic</strong>:原子性，同一时刻只能有一个线程能访问该属性，在进行属性的get/set时候是安全的。也就是说atomic只能在一定程度上保证线程安全，并不是一定的线程安全。</p>
<blockquote>
<p>因为原子属性是保证同一时刻只能有一个线程操作该对象，但是不能保证在一次完整的set -&gt; get操作过程中，只有同一个线程操作。比如，线程A先set该属性，完成后线程B也set了该属性，改变了原来的值，在B完成后A再进行get操作，此时会发现属性的值已经不是当初A线程set进去的，因此会有问题。另外一种更极端的情况是在A线程set完成，B线程进入把该对象release了，等A线程再来访问时就会导致crash。所以想要真正的线程安全，还是需要使用到加锁来实现，具体实现就不在本文的讨论范围了。</p>
</blockquote>
<p><strong> 2. nonatomic</strong> :非原子性，顾名思义也就是和atomic含义是相反的。不保证线程安全，可以多个线程同时访问。</p>
<blockquote>
<p>小结：在日常开发中，我们绝大部分时候都是使用nonatomic，最主要的原因是nonatomic效率比atomic高很多（坊间传闻约快20倍，具体没有去验证过），因此，在明确只有一个线程访问的情况下推荐使用nonatomic。但是，并不是说任何时候都是用nonatomic，具体要根据实际情况，如果某属性确实存在线程不安全的问题，还是要考虑使用atomic的。</p>
</blockquote>
<hr>
<h3 id="存取控制"><a href="#存取控制" class="headerlink" title="存取控制"></a>存取控制</h3><h4 id="readwrite-readonly-writeonly"><a href="#readwrite-readonly-writeonly" class="headerlink" title="readwrite | readonly | writeonly"></a>readwrite | readonly | writeonly</h4><ol>
<li><p>readwrite：可读可写，默认值。同时拥有getter和setter方法</p>
</li>
<li><p>readonly：可读不可写，只有getter没有setter方法</p>
</li>
<li><p>writeonly：可写不可读，只有setter没有getter方法，很少使用</p>
</li>
</ol>
<p>相对来说，这几个关键字是很简单也容易理解的。</p>
<hr>
<h3 id="内存管理"><a href="#内存管理" class="headerlink" title="内存管理"></a>内存管理</h3><h4 id="strong-weak-unsafe-unretained-assign-retain-copy"><a href="#strong-weak-unsafe-unretained-assign-retain-copy" class="headerlink" title="strong | weak | unsafe_unretained | assign | retain | copy"></a>strong | weak | unsafe_unretained | assign | retain | copy</h4><p><strong>1. assign:</strong><br>（1）默认值，用于修饰值类型（基本数据类型），如：int，float，double，CGFloat，NSInteger等。另外就是不存在所有权关系的对象，如：delegate。<br>（2）assign修饰的属性不牵涉内存管理，不会被引用计数器管理。</p>
<p><strong>2. retain:</strong><br>  针对对象类型，对的对象执行引用计数器+1的操作。也就是对传入的对象拥有所有权，是强引用。</p>
<p><strong>3. strong:</strong><br>ARC后用于取代retain的，作用等同于retain。表示实例变量对传入的对象要有所有权关系，也就是强引用。</p>
<p><strong>4. weak:</strong><br>针对对象类型，在setter方法中，不会对传入的对象执行引用计数器+1的操作。也就是对传入的对象没有所有权，是弱引用。另外当传入的对象引用计数器为0，也就是被释放后，用weak声明的实例变量会指向nil，即空对象。</p>
<p><strong>5. unsafe_unretained:</strong><br>（1）从字面上来看，我们可以拆分成两部分来理解，unretained和retain相反，也就是和strong相反，因此等同于weak，其实也是用在iOS5之前替代weak使用的<br>（2）unsafe，不安全的，如上所述等同于weak的话那应该是安全的，这里不安全的是指当传入的对象被释放后，使用unsafe_unretained修饰的变量是不知道的，也不会像weak一样指向nil，所以此时访问可能会引起crash。因此，总结来说unsafe_unretained作用是等同于weak，但是是不安全的。</p>
<p><strong>6. copy:</strong>在不同情况下会有不同的操作<br>（1）传入的对象是不可变的，如NSString对象<br>  A. 强引用传进来的对象，使其引用计数器+1，等同于strong<br>  B. 该变量指向地址和传入对象的指向地址一致<br>（2）传入对象是可变对象，如NSMutableString对象<br>A. 拷贝一份传入对象，生成一个新的对象，值等同于传入对象值，但是不会强引用传入对象<br>B. 此时变量指向地址就是上述生成的新对象地址，与传入对象地址无关，也不相同；因此，传入对象改变也不会影响到当前变量的值，两者已经是不相干的两个对象了。</p>
<blockquote>
<p>关于copy更多深入分析 <a href="http://southpeak.github.io/2015/05/10/ios-techset-1/" target="_blank" rel="noopener">请参考此文</a></p>
</blockquote>
<hr>
<h3 id="几个常见问题"><a href="#几个常见问题" class="headerlink" title="几个常见问题"></a>几个常见问题</h3><h4 id="unsafe-unretained、weak、assign-的区别？"><a href="#unsafe-unretained、weak、assign-的区别？" class="headerlink" title="unsafe_unretained、weak、assign 的区别？"></a>unsafe_unretained、weak、assign 的区别？</h4><ol>
<li>三者都不会对引用计数器进行操作，都不是对象的拥有者</li>
<li>unsafe_unretained作用等同于weak，但其实不安全的，不会对传入的对象做赋nil处理，可能产生野指针。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@property(nonatomic,strong) NSString *strongString;</span><br><span class="line">@property(nonatomic, unsafe_unretained) NSString *unsafe_unretainedString;</span><br><span class="line">self.strongString= [[NSStringalloc] initWithString:&quot;strongString&quot;];</span><br><span class="line">self.unsafe_unretainedString=self.strongString;</span><br><span class="line">self.strongString=nil;</span><br><span class="line">NSLog(@&quot;unsafe_unretainedString == %@&quot;,self.unsafe_unretainedString);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>这时打印unsafe_unretainedString的值时程序会crash掉。原因是strongString已经释放掉了，但是unsafe_unretainedString并不知道已被释放，所以造成了unsafe_unretainedString访问野指针的内存。</p>
</blockquote>
<p>3.assign用于修饰值类型或id，当被释放后如果不手动赋nil，会产生野指针<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@property(nonatomic,strong) NSString *strongString;</span><br><span class="line">@property(nonatomic,assign) NSString *assignString;</span><br><span class="line">self.strongString= [[NSString alloc] initWithString:&quot;strongString&quot;];</span><br><span class="line">self.assignString=self.strongString;</span><br><span class="line">self.strongString=nil;</span><br><span class="line">NSLog(@&quot;assignString == %@&quot;,self.assignString);</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>assign的问题和unsafe_unretained类似，可能会产生野指针。</p>
</blockquote>
<p>4.weak修饰的变量，当传入的对象被释放后，会自动指向nil，不会产生野指针<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@property(nonatomic,strong) NSString *strongString;</span><br><span class="line">@property(nonatomic,weak) NSString *weakString;</span><br><span class="line">self.strongString= [[NSStringalloc] initWithString:&quot;strongString&quot;];</span><br><span class="line">self.weakString=self.strongString;</span><br><span class="line">self.strongString=nil;</span><br><span class="line">NSLog(@&quot;weakString == %@&quot;,self.weakString);</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>由于 self.strongString与self.weakString指向同一地址，且self.weakString没有retain内存地址，而self.strongString =nil释放 了内存，所以self.strongString为nil。由于self.weakString声明为weak的指针，指针指向的地址一旦被释放，这些指针都将被赋值为nil。这样的好处能有效的防止野指针。</p>
</blockquote>
<hr>
<h4 id="delegate使用assign还是weak，为什么？"><a href="#delegate使用assign还是weak，为什么？" class="headerlink" title="delegate使用assign还是weak，为什么？"></a>delegate使用assign还是weak，为什么？</h4><ol>
<li>理论上来说，两者都是可以使用的，其一，都不会操作delegate的引用计数器，不是强引用对象。其二，在实际开发中，几乎所有场景下，delegate所指向的对象A的生存期都会被delegate变量B自身的生存期覆盖，也就是说A在使用B的过程中，B都是存在的，因此使用assign也不会有问题。</li>
<li>但是，由于assign不会处理delegate被释放后的情况，上述的也只是大部分情况，不排除可能会出现delegate被释放了而A还在使用，产生野指针错误，而weak正好会处理这个情况，因此我们一般使用weak来修饰delegate，会更加安全</li>
</ol>
<hr>
<h4 id="self对象是被strong，weak还是其他关键字修饰的？"><a href="#self对象是被strong，weak还是其他关键字修饰的？" class="headerlink" title="self对象是被strong，weak还是其他关键字修饰的？"></a>self对象是被strong，weak还是其他关键字修饰的？</h4><blockquote>
<p>在实际开发中，我们随处可见[self testMothod];这种写法，但是真正去思考self的生命周期和内存管理的估计很少。试问假如self在方法执行的过程中被释放了，会发生什么？</p>
</blockquote>
<p>通过 <a href="http://clang.llvm.org/docs/AutomaticReferenceCounting.html#self" target="_blank" rel="noopener">查阅clang文档</a>，我们发现了关于self的解释：</p>
<blockquote>
<p>The self parameter variable of an Objective-C method is never actually retained by the implementation. It is undefined behavior, or at least dangerous, to cause an object to be deallocated during a message send to that object.<br>To make this safe, for Objective-C instance methods self is implicitly const unless the method is in the init family. Further, self is always implicitly const within a class method.<br>Rationale<br>The cost of retaining self in all methods was found to be prohibitive, as it tends to be live across calls, preventing the optimizer from proving that the retain and release are unnecessary — for good reason, as it’s quite possible in theory to cause an object to be deallocated during its execution without this retain and release. Since it’s extremely uncommon to actually do so, even unintentionally, and since there’s no natural way for the programmer to remove this retain/release pair otherwise (as there is for other parameters by, say, making the variable __unsafe_unretained), we chose to make this optimizing assumption and shift some amount of risk to the user.</p>
</blockquote>
<p>上述，self既不是strong也不是weak，而是被unsafe_unretained修饰的，因此要求我们调用的时候保证self是存在的，否则可能会引起无法预料的crash。这样设计的原因是因为在对象方法调用时，我们一定是会把self传递进去，并且在绝大部分情况下做为调用方，我们不会把self释放掉，如果为了处理不到1%情况下的异常而在方法执行时增加retain和release进行保护的话，会对性能有重大影响，因此ARC设计也就没有帮我们处理，需要调用方自行保证self的存在。</p>
<blockquote>
<p>以上便是对iOS常用的property后关键字的分析理解。另外，关于copy和block的使用和探讨将在后续的文章进行，这块较复杂内容也较多。</p>
</blockquote>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"><i class="fa fa-tag"></i> iOS</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/12/11/iOS开发中的各种锁/" rel="next" title="iOS开发中的各种锁">
                <i class="fa fa-chevron-left"></i> iOS开发中的各种锁
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/12/11/深入理解RunLoop/" rel="prev" title="深入理解RunLoop">
                深入理解RunLoop <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://avatars1.githubusercontent.com/u/8272390?s=400&u=bbaa08ebea7648f5f5e56559bea1db50cc78d4ca&v=4avatar"
                alt="MrLeoZou" />
            
              <p class="site-author-name" itemprop="name">MrLeoZou</p>
              <p class="site-description motion-element" itemprop="description">时间真是不够用呐~</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/MrLeoZou" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://www.jianshu.com/u/651e24c3a2de" target="_blank" title="简书">
                    
                      <i class="fa fa-fw fa-book"></i>简书</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://weibo.com/Leo_zzp" target="_blank" title="Weibo">
                    
                      <i class="fa fa-fw fa-weibo"></i>Weibo</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#摘要"><span class="nav-number">1.</span> <span class="nav-text">摘要</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#小Tip"><span class="nav-number">2.</span> <span class="nav-text">小Tip</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#属性和变量"><span class="nav-number">2.1.</span> <span class="nav-text">属性和变量</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#property的关键字"><span class="nav-number">3.</span> <span class="nav-text">@property的关键字</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#原子性"><span class="nav-number">3.1.</span> <span class="nav-text">原子性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#atomic-nonatomic"><span class="nav-number">3.1.1.</span> <span class="nav-text">atomic | nonatomic</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#存取控制"><span class="nav-number">3.2.</span> <span class="nav-text">存取控制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#readwrite-readonly-writeonly"><span class="nav-number">3.2.1.</span> <span class="nav-text">readwrite | readonly | writeonly</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#内存管理"><span class="nav-number">3.3.</span> <span class="nav-text">内存管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#strong-weak-unsafe-unretained-assign-retain-copy"><span class="nav-number">3.3.1.</span> <span class="nav-text">strong | weak | unsafe_unretained | assign | retain | copy</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#几个常见问题"><span class="nav-number">3.4.</span> <span class="nav-text">几个常见问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#unsafe-unretained、weak、assign-的区别？"><span class="nav-number">3.4.1.</span> <span class="nav-text">unsafe_unretained、weak、assign 的区别？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#delegate使用assign还是weak，为什么？"><span class="nav-number">3.4.2.</span> <span class="nav-text">delegate使用assign还是weak，为什么？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#self对象是被strong，weak还是其他关键字修饰的？"><span class="nav-number">3.4.3.</span> <span class="nav-text">self对象是被strong，weak还是其他关键字修饰的？</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-bath" aria-hidden="true"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">MrLeoZou</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  

    
      <script id="dsq-count-scr" src="https://MrLeoZou.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://yoursite.com/2017/12/11/理解-property使用的关键字/';
          this.page.identifier = '2017/12/11/理解-property使用的关键字/';
          this.page.title = '理解@property使用的关键字';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://MrLeoZou.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  














  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.3"></script>



  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("R1f7SJR0SIun1yWOd6SCpg9w-gzGzoHsz", "mx6hbdneK5mrzGgJxzyfnzRL");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  

</body>
</html>
